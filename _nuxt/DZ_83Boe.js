import{d as T,M as C,v as E,N as B,s as j,J as c,n as H,o as u,c as h,e as o,a,t,f as w,b as n,K as k,w as y,T as U,h as N,i as v,j as K,a6 as S,g as z,k as A,C as R}from"./B2QG29PG.js";import{_ as D}from"./uCClg5Q7.js";const J={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},O={class:"flex flex-col items-center"},W={class:"text-xl font-semibold lg:text-3xl"},F={for:"password",class:"mb-4"},G={for:"confirmPassword",class:"mb-4"},Q={key:0,class:"text-sm mb-4"},X=["innerHTML"],Y={class:"flex items-center justify-center gap-4 mt-4 text-lg"},Z={class:"my-8 text-center cursor-pointer"},ss=T({__name:"ResetPassword",setup(V){const{t:r}=C(),i=E(),d=B(),{viewer:L,resetPasswordWithKey:$,loginUser:q}=j(),l=c(""),m=c(""),_=c(""),g=c(!1),f=c(!1);!d.query.key&&!d.query.login&&i.push("/my-account?action=forgotPassword");const I=async()=>{try{if(_.value="",f.value=!1,g.value=!0,l.value!==m.value)throw new Error(r("messages.error.passwordMismatch"));const e={key:d.query.key,login:d.query.login,password:l.value};if(!e.key||!e.login)throw f.value=!0,new Error(r("messages.error.invalidPasswordResetLink"));const s=await $(e);if(!s.success)throw f.value=!0,new Error(s.error);if(L.value){const p=await q({username:e.login,password:e.password});if(!p.success)throw new Error(p.error)}i.push("/my-account")}catch(e){_.value=e.message||r("messages.error.general")}finally{g.value=!1}};return H({title:r("messages.account.resetPassword")}),(e,s)=>{const p=S,P=D,b=z,M=A;return u(),h("div",J,[o("div",O,[a(p,{class:"mb-6 scale-125"}),o("h1",W,t(e.$t("messages.account.resetPassword")),1)]),o("form",{class:"mt-6 flex flex-col",onSubmit:K(I,["prevent"])},[o("label",F,[w(t(e.$t("messages.account.newPassword"))+" ",1),s[2]||(s[2]=o("span",{class:"text-red-500"},"*",-1)),s[3]||(s[3]=o("br",null,null,-1)),a(P,{id:"password",className:" border rounded-lg w-full p-3 px-4 bg-white",modelValue:n(l),"onUpdate:modelValue":s[0]||(s[0]=x=>k(l)?l.value=x:null),placeholder:"New Password",required:!0},null,8,["modelValue"])]),o("label",G,[w(t(e.$t("messages.account.confirmNewPassword"))+" ",1),s[4]||(s[4]=o("span",{class:"text-red-500"},"*",-1)),s[5]||(s[5]=o("br",null,null,-1)),a(P,{id:"confirmPassword",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:n(m),"onUpdate:modelValue":s[1]||(s[1]=x=>k(m)?m.value=x:null),placeholder:"Confirm Password",required:!0},null,8,["modelValue"])]),a(U,{name:"scale-y",mode:"out-in"},{default:y(()=>[n(_)?(u(),h("div",Q,[o("span",{class:"text-red-500",innerHTML:n(_)},null,8,X),n(f)?(u(),N(b,{key:0,class:"underline cursor-pointer pl-1",to:"/my-account?action=forgotPassword"},{default:y(()=>[w(t(e.$t("messages.account.requestNewLink")),1)]),_:1})):v("",!0)])):v("",!0)]),_:1}),o("button",Y,[n(g)?(u(),N(M,{key:0,stroke:"4",size:"16",color:"#fff"})):v("",!0),o("span",null,t(e.$t("messages.account.resetPassword")),1)])],32),o("div",Z,[a(b,{to:"/my-account"},{default:y(()=>[w(t(e.$t("messages.account.backToLogin")),1)]),_:1})])])}}}),es=Object.assign(R(ss,[["__scopeId","data-v-fd1df6fc"]]),{__name:"ResetPassword"}),os={},ts={class:"container min-h-[600px]"};function ns(V,r){const i=es;return u(),h("div",ts,[a(i)])}const ls=R(os,[["render",ns]]);export{ls as default};
