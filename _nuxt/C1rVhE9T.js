import{q as ce,s as oe,u as A,G as Ee,v as Me,x as Ue,y as Pe,d as H,z as ne,o as r,c as p,e as t,t as u,A as w,B as S,b as e,i as y,a as $,C as fe,F as q,r as ee,D as le,E as _e,_ as te,H as ae,I as he,h as L,J as O,K as Te,j as ge,w as I,T as J,k as ie,f as K,L as Le,M as Ae,N as Ie,m as Ne,O as je,P as De,Q as pe,R as Oe,g as qe,S as He}from"./B2QG29PG.js";import{_ as ze}from"./uCClg5Q7.js";import{_ as ye,a as ve}from"./wOPNRx5d.js";import{a as Be}from"./CCPmAvuQ.js";import"./B3hfmSqP.js";import"./BsJgsdEj.js";import"./BtQzQ6bP.js";const Ge=window.setInterval;function re(){const m=ce("orderInput",()=>({customerNote:"",paymentMethod:"",shipToDifferentAddress:!1,metaData:[{key:"order_via",value:"WooNuxt"}]})),l=ce("isProcessingOrder",()=>!1);async function i(){var c;const{customer:o,viewer:d}=oe(),{isUpdatingCart:g,refreshCart:a}=A();g.value=!0;try{const{updateCustomer:f}=await Ee({input:{id:(c=d==null?void 0:d.value)==null?void 0:c.id,shipping:m.value.shipToDifferentAddress?o.value.shipping:o.value.billing,billing:o.value.billing}});f&&a()}catch(f){console.error(f)}}function n(o){return new Promise(d=>{const c=window.innerWidth/2-375,f=window.innerHeight/2-750/2+80,v=window.open(o,"",`width=750,height=750,top=${f},left=${c}`),k=Ge(()=>{v!=null&&v.closed&&(clearInterval(k),d(!0))},500)})}return{orderInput:m,isProcessingOrder:l,proccessCheckout:async(o=!1)=>{var E,M,D,B,Z;const{customer:d,loginUser:g}=oe(),a=Me(),{replaceQueryParam:c}=Ue(),{emptyCart:f,refreshCart:v}=A();l.value=!0;const{username:k,password:z,shipToDifferentAddress:N}=m.value,j=(E=d.value)==null?void 0:E.billing,se=N?(M=d.value)==null?void 0:M.shipping:j;try{let U={billing:j,shipping:se,metaData:m.value.metaData,paymentMethod:m.value.paymentMethod.id,customerNote:m.value.customerNote,shipToDifferentAddress:N,transactionId:m.value.transactionId,isPaid:o};m.value.createAccount&&(U.account={username:k,password:z});const{checkout:b}=await Pe(U);m.value.createAccount&&await g({username:k,password:z});const G=(D=b==null?void 0:b.order)==null?void 0:D.databaseId,R=(B=b==null?void 0:b.order)==null?void 0:B.orderKey,W=m.value.paymentMethod.id,h=W==="paypal"||W==="ppcp-gateway";if(await(b==null?void 0:b.redirect)&&h){const _=window.location.origin;let C=(b==null?void 0:b.redirect)??"";const P=`${_}/checkout/order-received/${G}/?key=${R}&from_paypal=true`,V=`${_}/checkout/?cancel_order=true&from_paypal=true`;C=c("return",P,C),C=c("cancel_return",V,C),C=c("bn","WooNuxt_Cart",C),await n(C)&&a.push(`/checkout/order-received/${G}/?key=${R}&fetch_delay=true`)}else a.push(`/checkout/order-received/${G}/?key=${R}`);if(await(b==null?void 0:b.result)!=="success")return alert("There was an error processing your order. Please try again."),window.location.reload(),b;await f(),await v()}catch(U){l.value=!1;const b=(Z=U==null?void 0:U.gqlErrors)==null?void 0:Z[0].message;return b!=null&&b.includes("An account is already registered with your email address")?(alert("An account is already registered with your email address"),null):(alert(b),null)}l.value=!1},updateShippingLocation:i}}const Re={class:"grid w-full gap-4 lg:grid-cols-2"},We={class:"w-full"},Ye={for:"first-name"},Fe={class:"w-full"},Ke={for:"last-name"},Je={key:0,class:"w-full col-span-full"},Ze={for:"address1"},Qe={key:1,class:"w-full col-span-full"},Xe={for:"address2"},et={key:2,class:"w-full"},tt={for:"city"},st={key:3,class:"w-full"},ot={for:"state"},nt={key:4,class:"w-full"},lt={for:"country"},at={key:5,class:"w-full"},it={for:"zip"},rt={key:6,class:"w-full col-span-full"},dt={for:"phone"},ut=H({__name:"BillingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),{isBillingAddressEnabled:i}=A(),s=ne(m,"modelValue");return(o,d)=>{const g=ye,a=ve;return r(),p("div",Re,[t("div",We,[t("label",Ye,u(o.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":d[0]||(d[0]=c=>e(s).firstName=c),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(s).firstName]])]),t("div",Fe,[t("label",Ke,u(o.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":d[1]||(d[1]=c=>e(s).lastName=c),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(s).lastName]])]),e(i)?(r(),p("div",Je,[t("label",Ze,u(o.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":d[2]||(d[2]=c=>e(s).address1=c),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(s).address1]])])):y("",!0),e(i)?(r(),p("div",Qe,[t("label",Xe,u(o.$t("messages.billing.address2"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":d[3]||(d[3]=c=>e(s).address2=c),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(s).address2]])])):y("",!0),e(i)?(r(),p("div",et,[t("label",tt,u(o.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":d[4]||(d[4]=c=>e(s).city=c),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(s).city]])])):y("",!0),e(i)?(r(),p("div",st,[t("label",ot,u(o.$t("messages.billing.state"))+" ("+u(o.$t("messages.general.optional"))+")",1),$(g,{id:"state",modelValue:e(s).state,"onUpdate:modelValue":d[5]||(d[5]=c=>e(s).state=c),"default-value":e(s).state,"country-code":e(s).country,onChange:e(l),autocomplete:"address-level1"},null,8,["modelValue","default-value","country-code","onChange"])])):y("",!0),e(i)?(r(),p("div",nt,[t("label",lt,u(o.$t("messages.billing.country")),1),$(a,{id:"country",modelValue:e(s).country,"onUpdate:modelValue":d[6]||(d[6]=c=>e(s).country=c),"default-value":e(s).country,onChange:e(l),autocomplete:"country"},null,8,["modelValue","default-value","onChange"])])):y("",!0),e(i)?(r(),p("div",at,[t("label",it,u(o.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":d[7]||(d[7]=c=>e(s).postcode=c),placeholder:"10001",autocomplete:"postal-code",type:"text",required:""},null,512),[[S,e(s).postcode]])])):y("",!0),e(i)?(r(),p("div",rt,[t("label",dt,u(o.$t("messages.billing.phone"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":d[8]||(d[8]=c=>e(s).phone=c),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(s).phone]])])):y("",!0)])}}}),ct=Object.assign(ut,{__name:"BillingDetails"}),pt={class:"grid w-full gap-4 lg:grid-cols-2"},mt={class:"w-full"},ft={for:"first-name"},_t={class:"w-full"},ht={for:"last-name"},gt={class:"w-full col-span-full"},yt={for:"address1"},vt={class:"w-full col-span-full"},bt={for:"address2"},$t={class:"w-full"},wt={for:"city"},xt={class:"w-full"},kt={for:"state"},St={class:"w-full"},Ct={for:"country"},Vt={class:"w-full"},Et={for:"zip"},Mt={class:"w-full col-span-full"},Ut={for:"phone"},Pt=H({__name:"ShippingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),n=ne(m,"modelValue");return(s,o)=>{const d=ye,g=ve;return r(),p("div",pt,[t("div",mt,[t("label",ft,u(s.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":o[0]||(o[0]=a=>e(n).firstName=a),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(n).firstName]])]),t("div",_t,[t("label",ht,u(s.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":o[1]||(o[1]=a=>e(n).lastName=a),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(n).lastName]])]),t("div",gt,[t("label",yt,u(s.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":o[2]||(o[2]=a=>e(n).address1=a),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(n).address1]])]),t("div",vt,[t("label",bt,u(s.$t("messages.billing.address2"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":o[3]||(o[3]=a=>e(n).address2=a),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(n).address2]])]),t("div",$t,[t("label",wt,u(s.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":o[4]||(o[4]=a=>e(n).city=a),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(n).city]])]),t("div",xt,[t("label",kt,u(s.$t("messages.billing.state"))+" ("+u(s.$t("messages.general.optional"))+")",1),$(d,{id:"state",modelValue:e(n).state,"onUpdate:modelValue":o[5]||(o[5]=a=>e(n).state=a),"default-value":e(n).state,"country-code":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","country-code","onChange"])]),t("div",St,[t("label",Ct,u(s.$t("messages.billing.country")),1),$(g,{id:"country",modelValue:e(n).country,"onUpdate:modelValue":o[6]||(o[6]=a=>e(n).country=a),"default-value":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","onChange"])]),t("div",Vt,[t("label",Et,u(s.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":o[7]||(o[7]=a=>e(n).postcode=a),placeholder:"10001",autocomplete:"postal-code",type:"text",required:""},null,512),[[S,e(n).postcode]])]),t("div",Mt,[t("label",Ut,u(s.$t("messages.billing.phone"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":o[8]||(o[8]=a=>e(n).phone=a),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(n).phone]])])])}}}),Tt=Object.assign(Pt,{__name:"ShippingDetails"}),Lt={class:"grid gap-4 shipping-options"},At=["onClick"],It=["innerHTML"],Nt={class:"font-semibold text-gray-600"},jt={__name:"ShippingOptions",props:{options:{type:Array,required:!0},activeOption:{type:String,required:!0}},setup(m){var o;const{updateShippingMethod:l}=A(),i=_e(),n=((o=i==null?void 0:i.public)==null?void 0:o.CURRENCY_SYMBOL)||"$",s=async d=>{await l(d)};return(d,g)=>{const a=te;return r(),p("div",Lt,[(r(!0),p(q,null,ee(m.options,c=>(r(),p("div",{key:c.id,class:le(["flex items-center justify-between option",{"active-option":c.id===m.activeOption}]),onClick:f=>s(c.id)},[t("div",null,[t("div",{class:"text-sm leading-tight text-gray-500",innerHTML:c.label},null,8,It),t("div",Nt,u(e(n))+u(c.cost),1)]),$(a,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,At))),128))])}}},Dt=fe(jt,[["__scopeId","data-v-9043ed77"]]),Ot={class:"flex gap-4 leading-tight flex-wrap"},qt=["onClick","title"],Ht=["innerHTML"],zt={key:0,class:"prose block w-full"},Bt=["innerHTML"],Gt=H({__name:"PaymentOptions",props:{modelValue:{},paymentGateways:{}},emits:["update:modelValue"],setup(m,{emit:l}){const i=m,n=ne(i,"modelValue"),s=ae(()=>n.value),o=l,d=g=>{o("update:modelValue",g)};return he(()=>{var g,a;(g=i.paymentGateways)!=null&&g.nodes.length&&d((a=i.paymentGateways)==null?void 0:a.nodes[0])}),(g,a)=>{var f;const c=te;return r(),p("div",Ot,[(r(!0),p(q,null,ee((f=g.paymentGateways)==null?void 0:f.nodes,v=>(r(),p("div",{key:v.id,class:le(["option",{"active-option":v.id===e(s).id}]),onClick:k=>d(v),title:(v==null?void 0:v.description)||(v==null?void 0:v.title)||"Payment Method"},[v.id==="stripe"?(r(),L(c,{key:0,name:"ion:card-outline",size:"20"})):v.id==="paypal"?(r(),L(c,{key:1,name:"ion:logo-paypal",size:"20"})):(r(),L(c,{key:2,name:"ion:cash-outline",size:"20"})),t("span",{class:"whitespace-nowrap",innerHTML:v.title},null,8,Ht),$(c,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,qt))),128)),e(s).description?(r(),p("div",zt,[t("p",{class:"text-sm text-gray-500",innerHTML:e(s).description},null,8,Bt)])):y("",!0)])}}}),Rt=Object.assign(fe(Gt,[["__scopeId","data-v-e7723a37"]]),{__name:"PaymentOptions"}),Wt={id:"card-element"},Yt=H({__name:"StripeElement",props:["stripe"],emits:["updateElement"],setup(m,{emit:l}){const{cart:i}=A(),n=ae(()=>i.value&&parseFloat(i.value.rawTotal)*100),s=l;let o=null;const d={mode:"payment",currency:"eur",amount:n.value},g=async()=>{o=m.stripe.elements(d),o.create("card",{hidePostalCode:!0}).mount("#card-element"),s("updateElement",o)};return he(()=>{g()}),(a,c)=>(r(),p("div",Wt))}}),Ft=Object.assign(Yt,{__name:"StripeElement"}),Kt=["placeholder"],Jt=["disabled"],Zt={key:1},Qt=["innerHTML"],Xt={key:0,class:"text-xs font-semibold uppercase flex flex-wrap gap-2"},es={key:0,class:"bg-primary border-primary border rounded-md flex bg-opacity-5 border-opacity-10 text-primary leading-none p-1.5 gap-1 items-center"},ts=["innerHTML"],ss=H({__name:"AddCoupon",setup(m){const{cart:l,isUpdatingCoupon:i,applyCoupon:n,removeCoupon:s}=A(),o=O(""),d=O("");async function g(){const{message:a}=await n(o.value);a?d.value=a:(o.value="",d.value="")}return(a,c)=>{const f=ie,v=te;return r(),p("div",null,[t("form",{class:"flex gap-1",onSubmit:ge(g,["prevent"])},[w(t("input",{id:"couponCode","onUpdate:modelValue":c[0]||(c[0]=k=>Te(o)?o.value=k:null),type:"text",placeholder:a.$t("messages.shop.couponCode"),class:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm outline-none",required:""},null,8,Kt),[[S,e(o)]]),t("button",{class:"flex items-center justify-center px-4 py-2 text-white bg-gray-800 border rounded-md shadow-sm outline-none min-w-20",disabled:e(i)},[e(i)?(r(),L(f,{key:0,color:"#fff",size:"16"})):(r(),p("span",Zt,u(a.$t("messages.general.apply")),1))],8,Jt)],32),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(d)?(r(),p("div",{key:0,class:"mt-2 text-xs text-red-600",innerHTML:e(d)},null,8,Qt)):y("",!0)]),_:1}),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",Xt,[(r(!0),p(q,null,ee(e(l).appliedCoupons,(k,z)=>(r(),p("div",{key:(k==null?void 0:k.code)||z,class:"flex flex-wrap mt-2 flex-2"},[k!=null&&k.code?(r(),p("div",es,[t("span",{innerHTML:k.code},null,8,ts),$(v,{name:"ion:close",class:"rounded-full cursor-pointer hover:bg-primary hover:text-white",onClick:N=>e(s)(k.code)},null,8,["onClick"])])):y("",!0)]))),128))])):y("",!0)]),_:1})])}}}),os=Object.assign(ss,{__name:"AddCoupon"}),ns={key:0,class:"bg-white rounded-lg shadow-lg mb-8 w-full min-h-[280px] p-4 sm:p-8 relative md:max-w-md md:top-32 md:sticky"},ls={class:"mb-6 text-xl font-semibold leading-none"},as={class:"flex flex-col gap-4 overflow-y-auto"},is={class:"grid gap-1 text-sm font-semibold text-gray-500"},rs={class:"flex justify-between"},ds=["innerHTML"],us={class:"flex justify-between"},cs={class:"text-gray-700 tabular-nums"},ps={key:0,class:"flex justify-between"},ms={class:"text-primary tabular-nums"},fs=["innerHTML"],_s={class:"flex justify-between mt-4"},hs=["innerHTML"],gs={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-50"},ys={__name:"OrderSummary",setup(m){const{cart:l,isUpdatingCart:i}=A();return(n,s)=>{const o=Be,d=os,g=ie;return e(l)?(r(),p("aside",ns,[t("h2",ls,u(n.$t("messages.shop.orderSummary")),1),t("ul",as,[(r(!0),p(q,null,ee(e(l).contents.nodes,a=>(r(),L(o,{key:a.key,item:a},null,8,["item"]))),128))]),$(d,{class:"my-8"}),t("div",is,[t("div",rs,[t("span",null,u(n.$t("messages.shop.subtotal")),1),t("span",{class:"text-gray-700 tabular-nums",innerHTML:e(l).subtotal},null,8,ds)]),t("div",us,[t("span",null,u(n.$t("messages.general.shipping")),1),t("span",cs,u(parseFloat(e(l).shippingTotal)>0?"+":"")+" "+u(e(l).shippingTotal),1)]),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",ps,[t("span",null,u(n.$t("messages.shop.discount")),1),t("span",ms,[s[0]||(s[0]=K("- ")),t("span",{innerHTML:e(l).discountTotal},null,8,fs)])])):y("",!0)]),_:1}),t("div",_s,[t("span",null,u(n.$t("messages.shop.total")),1),t("span",{class:"text-lg font-bold text-gray-700 tabular-nums",innerHTML:e(l).total},null,8,hs)])]),Le(n.$slots,"default"),e(i)?(r(),p("div",gs,[$(g)])):y("",!0)])):y("",!0)}}};var be="https://js.stripe.com/v3",vs=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var bs=function(){for(var l=document.querySelectorAll('script[src^="'.concat(be,'"]')),i=0;i<l.length;i++){var n=l[i];if(vs.test(n.src))return n}return null},me=function(l){var i="",n=document.createElement("script");n.src="".concat(be).concat(i);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},$s=function(l,i){!l||!l._registerWrapper||l._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:i})},Y=null,Q=null,X=null,ws=function(l){return function(){l(new Error("Failed to load Stripe.js"))}},xs=function(l,i){return function(){window.Stripe?l(window.Stripe):i(new Error("Stripe.js not available"))}},ks=function(l){return Y!==null?Y:(Y=new Promise(function(i,n){if(typeof window>"u"||typeof document>"u"){i(null);return}if(window.Stripe){i(window.Stripe);return}try{var s=bs();if(!(s&&l)){if(!s)s=me(l);else if(s&&X!==null&&Q!==null){var o;s.removeEventListener("load",X),s.removeEventListener("error",Q),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=me(l)}}X=xs(i,n),Q=ws(n),s.addEventListener("load",X),s.addEventListener("error",Q)}catch(d){n(d);return}}),Y.catch(function(i){return Y=null,Promise.reject(i)}))},Ss=function(l,i,n){if(l===null)return null;var s=l.apply(void 0,i);return $s(s,n),s},F,$e=!1,we=function(){return F||(F=ks(null).catch(function(l){return F=null,Promise.reject(l)}),F)};Promise.resolve().then(function(){return we()}).catch(function(m){$e||console.warn(m)});var Cs=function(){for(var l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];$e=!0;var s=Date.now();return we().then(function(o){return Ss(o,i,s)})};const Vs={class:"flex flex-col min-h-[600px]"},Es={key:0,class:"flex flex-col items-center justify-center flex-1 mb-12"},Ms={class:"text-2xl font-bold mb-2"},Us={class:"text-gray-400 mb-4"},Ps={class:"grid w-full max-w-2xl gap-8 checkout-form md:flex-1"},Ts={key:0},Ls={class:"w-full mt-4"},As={for:"email"},Is={key:0,class:"mt-1 text-sm text-red-500"},Ns={class:"w-full mt-4"},js={for:"username"},Ds={key:0,class:"w-full my-2"},Os={for:"email"},qs={key:1,class:"flex items-center gap-2 my-2"},Hs={class:"w-full mb-3 text-2xl font-semibold"},zs={key:1,for:"shipToDifferentAddress",class:"flex items-center gap-2"},Bs={key:0},Gs={class:"mb-4 text-xl font-semibold"},Rs={key:2},Ws={class:"mb-4 text-xl font-semibold"},Ys={key:3,class:"mt-2 col-span-full"},Fs={class:"mb-4 text-xl font-semibold"},Ks={class:"mb-4 text-xl font-semibold"},Js=["placeholder"],Zs=["disabled"],lo=H({__name:"checkout",async setup(m){var W;let l,i;const{t:n}=Ae(),{query:s}=Ie(),{cart:o,isUpdatingCart:d,paymentGateways:g}=A(),{customer:a,viewer:c}=oe(),{orderInput:f,isProcessingOrder:v,proccessCheckout:k}=re(),N=((W=_e().public)==null?void 0:W.STRIPE_PUBLISHABLE_KEY)||null,j=O(v.value?n("messages.general.processing"):n("messages.shop.checkoutButton")),se=ae(()=>v.value||d.value||!f.value.paymentMethod),E=O(!1),M=N?([l,i]=Ne(()=>Cs(N)),l=await l,i(),l):null,D=O(),B=O(!1);je(async()=>{s.cancel_order&&window.close()});const Z=async()=>{var C;j.value=n("messages.general.processing");const{stripePaymentIntent:h}=await He(),_=(h==null?void 0:h.clientSecret)||"";try{if(f.value.paymentMethod.id==="stripe"&&M&&D.value){const P=D.value.getElement("card"),{setupIntent:V}=await M.confirmCardSetup(_,{payment_method:{card:P}}),{source:T}=await M.createSource(P);T&&f.value.metaData.push({key:"_stripe_source_id",value:T.id}),V&&f.value.metaData.push({key:"_stripe_intent_id",value:V.id}),B.value=(V==null?void 0:V.status)==="succeeded"||!1,f.value.transactionId=((C=T==null?void 0:T.created)==null?void 0:C.toString())||new Date().getTime().toString()}}catch(P){console.error(P),j.value=n("messages.shop.placeOrder")}k(B.value)},U=h=>{D.value=h},b=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,G=h=>{h&&(E.value=!b.test(h))},R=h=>{h&&E.value&&(E.value=!b.test(h))};return De({title:n("messages.shop.checkout")}),(h,_)=>{var ue;const C=te,P=qe,V=ze,T=ct,xe=Tt,ke=Dt,Se=Rt,Ce=Ft,de=ie,Ve=ys;return r(),p("div",Vs,[e(o)&&e(a)?(r(),p(q,{key:0},[e(o).isEmpty?(r(),p("div",Es,[$(C,{name:"ion:cart-outline",size:"156",class:"opacity-25 mb-5"}),t("h2",Ms,u(h.$t("messages.shop.cartEmpty")),1),t("span",Us,u(h.$t("messages.shop.addProductsInYourCart")),1),$(P,{to:"/products",class:"flex items-center justify-center gap-3 p-2 px-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark"},{default:I(()=>[K(u(h.$t("messages.shop.browseOurProducts")),1)]),_:1})])):(r(),p("form",{key:1,class:"container flex flex-wrap items-start gap-8 my-16 justify-evenly lg:gap-20",onSubmit:ge(Z,["prevent"])},[t("div",Ps,[!e(c)&&e(a).billing?(r(),p("div",Ts,[_[12]||(_[12]=t("h2",{class:"w-full mb-2 text-2xl font-semibold leading-none"},"Contact Information",-1)),_[13]||(_[13]=t("p",{class:"mt-1 text-sm text-gray-500"},[K("Already have an account? "),t("a",{href:"/my-account",class:"text-primary text-semibold"},"Log in"),K(".")],-1)),t("div",Ls,[t("label",As,u(h.$t("messages.billing.email")),1),w(t("input",{"onUpdate:modelValue":_[0]||(_[0]=x=>e(a).billing.email=x),placeholder:"johndoe@email.com",autocomplete:"email",type:"email",name:"email",class:le({"has-error":e(E)}),onBlur:_[1]||(_[1]=x=>G(e(a).billing.email)),onInput:_[2]||(_[2]=x=>R(e(a).billing.email)),required:""},null,34),[[S,e(a).billing.email]]),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(E)?(r(),p("div",Is,"Invalid email address")):y("",!0)]),_:1})]),e(f).createAccount?(r(),p(q,{key:0},[t("div",Ns,[t("label",js,u(h.$t("messages.account.username")),1),w(t("input",{"onUpdate:modelValue":_[3]||(_[3]=x=>e(f).username=x),placeholder:"johndoe",autocomplete:"username",type:"text",name:"username",required:""},null,512),[[S,e(f).username]])]),e(f).createAccount?(r(),p("div",Ds,[t("label",Os,u(h.$t("messages.account.password")),1),$(V,{id:"password",class:"my-2",modelValue:e(f).password,"onUpdate:modelValue":_[4]||(_[4]=x=>e(f).password=x),placeholder:"••••••••••",required:!0},null,8,["modelValue"])])):y("",!0)],64)):y("",!0),e(c)?y("",!0):(r(),p("div",qs,[_[11]||(_[11]=t("label",{for:"creat-account"},"Create an account?",-1)),w(t("input",{id:"creat-account","onUpdate:modelValue":_[5]||(_[5]=x=>e(f).createAccount=x),type:"checkbox",name:"creat-account"},null,512),[[pe,e(f).createAccount]])]))])):y("",!0),t("div",null,[t("h2",Hs,u(h.$t("messages.billing.billingDetails")),1),$(T,{modelValue:e(a).billing,"onUpdate:modelValue":_[6]||(_[6]=x=>e(a).billing=x)},null,8,["modelValue"])]),e(o).availableShippingMethods.length>0?(r(),p("label",zs,[t("span",null,u(h.$t("messages.billing.differentAddress")),1),w(t("input",{id:"shipToDifferentAddress","onUpdate:modelValue":_[7]||(_[7]=x=>e(f).shipToDifferentAddress=x),type:"checkbox",name:"shipToDifferentAddress"},null,512),[[pe,e(f).shipToDifferentAddress]])])):y("",!0),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(f).shipToDifferentAddress?(r(),p("div",Bs,[t("h2",Gs,u(h.$t("messages.general.shippingDetails")),1),$(xe,{modelValue:e(a).shipping,"onUpdate:modelValue":_[8]||(_[8]=x=>e(a).shipping=x)},null,8,["modelValue"])])):y("",!0)]),_:1}),e(o).availableShippingMethods.length?(r(),p("div",Rs,[t("h3",Ws,u(h.$t("messages.general.shippingSelect")),1),$(ke,{options:e(o).availableShippingMethods[0].rates,"active-option":e(o).chosenShippingMethods[0]},null,8,["options","active-option"])])):y("",!0),(ue=e(g))!=null&&ue.nodes.length?(r(),p("div",Ys,[t("h2",Fs,u(h.$t("messages.billing.paymentOptions")),1),$(Se,{modelValue:e(f).paymentMethod,"onUpdate:modelValue":_[9]||(_[9]=x=>e(f).paymentMethod=x),class:"mb-4",paymentGateways:e(g)},null,8,["modelValue","paymentGateways"]),e(M)?w((r(),L(Ce,{key:0,stripe:e(M),onUpdateElement:U},null,8,["stripe"])),[[Oe,e(f).paymentMethod.id=="stripe"]]):y("",!0)])):y("",!0),t("div",null,[t("h2",Ks,u(h.$t("messages.shop.orderNote"))+" ("+u(h.$t("messages.general.optional"))+")",1),w(t("textarea",{id:"order-note","onUpdate:modelValue":_[10]||(_[10]=x=>e(f).customerNote=x),name:"order-note",class:"w-full min-h-[100px]",rows:"4",placeholder:h.$t("messages.shop.orderNotePlaceholder")},null,8,Js),[[S,e(f).customerNote]])])]),$(Ve,null,{default:I(()=>[t("button",{class:"flex items-center justify-center w-full gap-3 p-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark disabled:cursor-not-allowed disabled:bg-gray-400",disabled:e(se)},[K(u(e(j)),1),e(v)?(r(),L(de,{key:0,color:"#fff",size:"18"})):y("",!0)],8,Zs)]),_:1})],32))],64)):(r(),L(de,{key:1,class:"m-auto"}))])}}});export{lo as default};
